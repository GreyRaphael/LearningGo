# Preparation

- [Preparation](#preparation)
	- [Fedora](#fedora)
	- [Windows](#windows)

## Fedora

Prepare development environment
1. Install golang SDK, `sudo dnf install golang`
1. VSCode install go extension
1. VSCode, `F1`, `Go: Install/Update Tools`(需要clash, global tunneled proxy)

example: create a simple project
> [How to use Go modules](https://www.digitalocean.com/community/tutorials/how-to-use-go-modules)

```bash
mkdir proj1
cd proj1

go mod init proj1
go mod tidy

touch main.go

go run .
# go run main.go

# build a binary 
go build

# reduce binary size
go build -ldflags="-s -w"
```

```bash
└── proj1
    └── main.go
    └── go.mod
```

```go
// main.go
package main

import "fmt"

func main() {
	fmt.Println("Hello, Modules!")
}
```

example: add custom module

```bash
└── proj1
    └── main.go
    └── go.mod
    └── mypackage
        └── mymath.go
        └── myphysics.go
```

```go
// mymath.go
package mypackage

import "fmt"

func PrintMath() {
	fmt.Println("Hello, Modules! from PrintMath!")
}
```

```go
// myphysics.go
package mypackage

import "fmt"

func PrintPhysics() {
	fmt.Println("Hello, Modules! from PrintPhysics")
}
```

```go
// main.go
package main

import (
	"fmt"
	"proj1/mypackage"
)

func main() {
	fmt.Println("hello world")
	mypackage.PrintMath()
	mypackage.PrintPhysics()
}
```

```bash
go run .
# or
go run main.go
```

example: add remote dependency from github.com, and etc.

```bash
└── proj1
    └── main.go
    └── go.mod
    └── mypackage
        └── mymath.go
        └── myphysics.go
```

```bash
# cobra被下载到 gopath/pkg
go get github.com/spf13/cobra
```

```go
// main.go
package main

import (
	"fmt"
	"proj1/mypackage"

	"github.com/spf13/cobra"
)

func main() {
	cmd := &cobra.Command{
		Run: func(cmd *cobra.Command, args []string) {
			fmt.Println("Hello World!")
			mypackage.PrintMath()
			mypackage.PrintPhysics()
		},
	}
	cmd.Execute()
}
```

## Windows

Prepare development environment
1. download golang sdk zip, <https://go.dev/dl/>
2. modify `go.env` file
3. manually install gotools
4. install vscode extension and setup


```bash
# D:/Dev/Golang/goroot/go.env
GOPROXY=https://proxy.golang.org,direct
GOSUMDB=sum.golang.org
# add this line
GOPATH=D:\Dev\Golang\gopath

GOTOOLCHAIN=auto
```

```bash
# install gotools in terminal
go install -v golang.org/x/tools/gopls@latest
go install -v golang.org/x/tools/cmd/goimports@latest
go install -v github.com/cweill/gotests/gotests@latest
go install -v github.com/fatih/gomodifytags@latest
go install -v github.com/josharian/impl@latest
go install -v github.com/haya14busa/goplay/cmd/goplay@latest
go install -v github.com/go-delve/delve/cmd/dlv@latest
go install -v honnef.co/go/tools/cmd/staticcheck@latest
```

```json
// vscode, settings.json
{
	"go.goroot": "D:\\Dev\\Golang\\goroot",
    "go.inlayHints.assignVariableTypes": true,
    "go.inlayHints.compositeLiteralFields": true,
    "go.inlayHints.compositeLiteralTypes": true,
    "go.inlayHints.constantValues": true,
    "go.inlayHints.functionTypeParameters": true,
    "go.inlayHints.parameterNames": true,
    "go.inlayHints.rangeVariableTypes": true
}
```